<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Simple Shop Demo ‚Äî Login / Signup / Home</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <meta name="description" content="Minimal online shop demo with Supabase Auth" />
  <!-- Supabase JS (UMD) -->
  <script src="https://unpkg.com/@supabase/supabase-js@2.45.4/dist/umd/supabase.js"></script>
</head>
<body class="bg-gray-50 text-gray-900 antialiased">
  <div id="app" class="min-h-screen flex flex-col">
    <!-- Header -->
    <header class="border-b bg-white">
      <div class="max-w-5xl mx-auto px-4 py-4 flex items-center justify-between">
        <a href="#home" class="font-semibold tracking-wide">üõçÔ∏è Simple Shop</a>
        <nav class="flex items-center gap-4">
          <a href="#home" class="text-sm hover:underline">Home</a>
          <!-- <a href="#login" class="text-sm hover:underline" id="Login">Login</a> -->
          <a href="#signup" class="text-sm hover:underline" id="nav-signup">Sign up</a>
          <button id="signout" class="hidden text-sm px-3 py-1 rounded-lg border hover:bg-gray-100">Signout</button>
        </nav>
      </div>
    </header>

    <!-- Main -->
    <main class="flex-1">
      <section id="page-home" class="hidden">
        <div class="max-w-5xl mx-auto px-4 py-12">
          <div class="bg-white border rounded-2xl p-8 shadow-sm">
            <h1 class="text-2xl font-bold mb-2">Welcome<span id="home-username"></span> üëã</h1>
            <p class="text-gray-600">This is your Home page. (Your product grid would go here.)</p>
            <div class="mt-8 grid sm:grid-cols-2 lg:grid-cols-3 gap-4">
              <div class="border rounded-xl p-4">
                <div class="h-28 bg-gray-100 rounded mb-3"></div>
                <div class="font-medium">Demo Product A</div>
                <div class="text-sm text-gray-500">‚Çπ499</div>
              </div>
              <div class="border rounded-xl p-4">
                <div class="h-28 bg-gray-100 rounded mb-3"></div>
                <div class="font-medium">Demo Product B</div>
                <div class="text-sm text-gray-500">‚Çπ899</div>
              </div>
              <div class="border rounded-xl p-4">
                <div class="h-28 bg-gray-100 rounded mb-3"></div>
                <div class="font-medium">Demo Product C</div>
                <div class="text-sm text-gray-500">‚Çπ1,299</div>
              </div>
            </div>
            <div class="mt-8">
              <a href="#login" class="text-blue-600 hover:underline" id="home-cta">Login to start</a>
            </div>
          </div>
        </div>
      </section>

      <section id="page-login" class="hidden">
        <div class="max-w-md mx-auto px-4 py-12">
          <div class="bg-white border rounded-2xl p-8 shadow-sm">
            <h2 class="text-xl font-semibold mb-6">Login</h2>
            <form id="login-form" class="grid gap-4" novalidate>
              <div>
                <label class="block text-sm mb-1" for="login-email">Email</label>
                <input id="login-email" type="email" required autocomplete="email"
                  class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring" />
                <p id="login-email-err" class="hidden text-sm text-red-600 mt-1">Please enter a valid email.</p>
              </div>
              <div>
                <label class="block text-sm mb-1" for="login-password">Password</label>
                <input id="login-password" type="password" required minlength="6" autocomplete="current-password"
                  class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring" />
                <p id="login-pass-err" class="hidden text-sm text-red-600 mt-1">Password must be at least 6 characters.</p>
              </div>
              <button class="mt-2 bg-black text-white rounded-lg px-4 py-2 hover:opacity-90">Login</button>
              <p class="text-sm text-gray-600">No account? <a href="#signup" class="text-blue-600 hover:underline">Create one</a>.</p>
              <p id="login-error" class="hidden text-sm text-red-600"></p>
            </form>
          </div>
        </div>
      </section>

      <section id="page-signup" class="hidden">
        <div class="max-w-md mx-auto px-4 py-12">
          <div class="bg-white border rounded-2xl p-8 shadow-sm">
            <h2 class="text-xl font-semibold mb-6">Create account</h2>
            <form id="signup-form" class="grid gap-4" novalidate>
              <div>
                <label class="block text-sm mb-1" for="signup-name">Name</label>
                <input id="signup-name" type="text" required minlength="2" autocomplete="name"
                  class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring" />
                <p id="signup-name-err" class="hidden text-sm text-red-600 mt-1">Please enter your name (2+ chars).</p>
              </div>
              <div>
                <label class="block text-sm mb-1" for="signup-email">Email</label>
                <input id="signup-email" type="email" required autocomplete="email"
                  class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring" />
                <p id="signup-email-err" class="hidden text-sm text-red-600 mt-1">Please enter a valid email.</p>
              </div>
              <div>
                <label class="block text-sm mb-1" for="signup-password">Password</label>
                <input id="signup-password" type="password" required minlength="6" autocomplete="new-password"
                  class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring" />
                <p id="signup-pass-err" class="hidden text-sm text-red-600 mt-1">Use 6+ characters.</p>
              </div>
              <button class="mt-2 bg-black text-white rounded-lg px-4 py-2 hover:opacity-90">Create account</button>
              <p class="text-sm text-gray-600">Already have an account? <a href="#login" class="text-blue-600 hover:underline">Login</a>.</p>
              <p id="signup-error" class="hidden text-sm text-red-600"></p>
              <p id="signup-success" class="hidden text-sm text-green-700"></p>
            </form>
          </div>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer class="border-t bg-white">
      <div class="max-w-5xl mx-auto px-4 py-6 text-sm text-gray-600">
        Demo only. Auth by Supabase. Customize freely.
      </div>
    </footer>
  </div>

  <script>
    // ====== 1) Configure Supabase ======
    const SUPABASE_URL = "https://rjtciknphcrilrczgvwv.supabase.co";          // <-- replace
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJqdGNpa25waGNyaWxyY3pndnd2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUwNjk5ODIsImV4cCI6MjA3MDY0NTk4Mn0.BdPe6ocR1Brg3XDU9pEmDaOXMjAgVqmp4Irga4IkWL4";                 // <-- replace
    const sb = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY, {
      auth: { persistSession: true, storageKey: 'demo_supabase_auth' }
    });

    // ====== 2) Basic Router ======
    const pages = {
      home: document.getElementById('page-home'),
      login: document.getElementById('page-login'),
      signup: document.getElementById('page-signup'),
    };
   // const navLogin = document.getElementById('Login');
    const navSignup = document.getElementById('nav-signup');
    const navLogout = document.getElementById('signout');
    const homeUsername = document.getElementById('home-username');
    const homeCta = document.getElementById('home-cta');

    function showPage(name) {
      Object.values(pages).forEach(el => el.classList.add('hidden'));
      pages[name]?.classList.remove('hidden');
      updateNav(); updateHome();
    }

    window.addEventListener('hashchange', () => {
      const route = location.hash.replace('#', '') || 'home';
      if (!pages[route]) location.hash = '#home'; else showPage(route);
    });

    // ====== 3) Auth helpers ======
    async function getCurrentUser() {
      const { data: { user } } = await sb.auth.getUser();
      return user;
    }
    async function signUpWithEmail(name, email, password) {
      // user_metadata.name will be available after sign-in
      const { data, error } = await sb.auth.signUp({ email, password, options: { data: { name } } });
      if (error) throw error;
      return data.user;
    }
    async function signInWithEmail(email, password) {
      const { data, error } = await sb.auth.signInWithPassword({ email, password });
      if (error) throw error;
      return data.user;
    }
    async function signOut() {
      await sb.auth.signOut();
    }

    function setMsg(id, text, isError=true) {
      const el = document.getElementById(id);
      el.textContent = text;
      el.classList.remove('hidden');
      el.classList.toggle('text-red-600', isError);
      el.classList.toggle('text-green-700', !isError);
      setTimeout(() => el.classList.add('hidden'), 3500);
    }

    async function updateHome() {
      const user = await getCurrentUser();
      const name = user?.user_metadata?.name || user?.email || '';
      homeUsername.textContent = user ? `, ${name}` : '';
      homeCta?.classList.toggle('hidden', !!user);
    }
    async function updateNav() {
      const user = await getCurrentUser();
      navLogin.classList.toggle('hidden', !!user);
      navSignup.classList.toggle('hidden', !!user);
      navLogout.classList.toggle('hidden', !user);
    }

    // ====== 4) Form handlers ======
    // Signup
    const suForm = document.getElementById('signup-form');
    suForm?.addEventListener('submit', async (e) => {
      e.preventDefault();
      const name = document.getElementById('signup-name').value.trim();
      const email = document.getElementById('signup-email').value.trim().toLowerCase();
      const password = document.getElementById('signup-password').value;

      const ok = name.length >= 2 && /\S+@\S+\.\S+/.test(email) && password.length >= 6;
      document.getElementById('signup-name-err').classList.toggle('hidden', name.length >= 2);
      document.getElementById('signup-email-err').classList.toggle('hidden', /\S+@\S+\.\S+/.test(email));
      document.getElementById('signup-pass-err').classList.toggle('hidden', password.length >= 6);
      if (!ok) return;

      try {
        await signUpWithEmail(name, email, password);
        // If email confirmation is OFF, user is signed in immediately.
        // If it's ON, they must confirm via email before session exists.
        setMsg('signup-success', 'Account created! You can now sign in.', false);
        setTimeout(() => location.hash = '#login', 900);
      } catch (err) {
        setMsg('signup-error', err.message || 'Sign-up failed');
      }
    });

    // Login
    const liForm = document.getElementById('login-form');
    liForm?.addEventListener('submit', async (e) => {
      e.preventDefault();
      const email = document.getElementById('login-email').value.trim().toLowerCase();
      const password = document.getElementById('login-password').value;

      const emailOk = /\S+@\S+\.\S+/.test(email);
      const passOk = password.length >= 6;
      document.getElementById('login-email-err').classList.toggle('hidden', emailOk);
      document.getElementById('login-pass-err').classList.toggle('hidden', passOk);
      if (!emailOk || !passOk) return;

      try {
        await signInWithEmail(email, password);
        location.hash = '#home';
      } catch (err) {
        setMsg('login-error', err.message || 'Login failed');
      }
    });

    // Logout
    document.getElementById('signout')?.addEventListener('click', async () => {
      await signOut();
      location.hash = '#home';
    });

    // ====== 5) Init ======
    if (!location.hash) location.hash = '#home';
    showPage(location.hash.replace('#', ''));
    // Keep UI in sync when auth state changes (e.g., email confirmation completes)
    sb.auth.onAuthStateChange(() => { updateNav(); updateHome(); });
  </script>
</body>
</html>



